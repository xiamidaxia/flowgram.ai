"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["594262"],{286809:function(e,n,d){d.r(n),d.d(n,{default:function(){return a}});var o=d(110239),t=d(444827);function s(e){let n=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",div:"div",h2:"h2"},(0,t.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.h1,{id:"flowdocument",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#flowdocument",children:"#"}),"FlowDocument"]}),"\n",(0,o.jsx)(n.p,{children:"Flow document (fixed layout), stores all node data of the process"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://flowgram.ai/auto-docs/document/classes/FlowDocument.html",rel:"noopener noreferrer",target:"_blank",children:"> API Detail"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"import { useClientContext } from '@flowgram.ai/fixed-layout-editor'\n\nconst ctx = useClientContext();\nconsole.log(ctx.document)\n"})}),"\n",(0,o.jsxs)(n.div,{className:"rspress-directive danger",children:[(0,o.jsx)(n.div,{className:"rspress-directive-title",children:"DANGER"}),(0,o.jsx)(n.div,{className:"rspress-directive-content",children:(0,o.jsxs)(n.p,{children:["\nThe best way to operate nodes is through ",(0,o.jsx)(n.a,{href:"/api/services/flow-operation-service.html",children:"ctx.operation"}),", so that it can be bound to redo/undo"]})})]}),"\n",(0,o.jsxs)(n.h2,{id:"root",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#root",children:"#"}),"root"]}),"\n",(0,o.jsx)(n.p,{children:"Get the root node of the canvas, all nodes are attached to the root node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"console.log(ctx.document.root);\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"getallnodes",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#getallnodes",children:"#"}),"getAllNodes"]}),"\n",(0,o.jsx)(n.p,{children:"Get all node data"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"const nodes = ctx.document.getAllNodes();\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"getnode",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#getnode",children:"#"}),"getNode"]}),"\n",(0,o.jsx)(n.p,{children:"Get node by specified id"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"ctx.document.getNode('start')\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"getnoderegistry",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#getnoderegistry",children:"#"}),"getNodeRegistry"]}),"\n",(0,o.jsx)(n.p,{children:"Get node definition, node definition can be extended according to business"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"const startNodeRegistry = ctx.document.getNodeRegistry<FlowNodeRegistry>('start')\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"fromjsontojson",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#fromjsontojson",children:"#"}),"fromJSON/toJSON"]}),"\n",(0,o.jsx)(n.p,{children:"Import and export data"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"const json = ctx.document.toJSON();\nctx.document.fromJSON(json);\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"registerflownodes",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#registerflownodes",children:"#"}),"registerFlowNodes"]}),"\n",(0,o.jsx)(n.p,{children:"Register node configuration items, supports inheritance"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"const node1: FlowNodeRegistry = {\n  type: 'node1',\n  meta: {}\n}\n\nconst node2: FlowNodeRegistry = {\n  type: 'node2',\n  extend: 'node1' // Inherit the configuration of node1\n}\nctx.document.registerFlowNodes(node1, node2)\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"addnode",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#addnode",children:"#"}),"addNode"]}),"\n",(0,o.jsx)(n.p,{children:"Add node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"ctx.document.addNode({\n  id: 'node1',\n  type: 'start',\n  meta: {},\n  data: {},\n  parent: ctx.document.root // Can specify a parent node\n});\n\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"addfromnode",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#addfromnode",children:"#"}),"addFromNode"]}),"\n",(0,o.jsx)(n.p,{children:"Add to the node after the specified node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"ctx.document.addFromNode(\n ctx.document.getNode('start'),\n { id: 'node1', type: 'custom', data: {} }\n);\n\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"addblock",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#addblock",children:"#"}),"addBlock"]}),"\n",(0,o.jsx)(n.p,{children:"Add a branch node to the specified node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"\nctx.document.addBlock(ctx.document.getNode('condition'), { id: 'if_1', type: 'block', data: {} })\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"removenode",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#removenode",children:"#"}),"removeNode"]}),"\n",(0,o.jsx)(n.p,{children:"Delete node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"ctx.document.removeNode('node1');\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"onnodecreateonnodeupdateonnodedispose",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#onnodecreateonnodeupdateonnodedispose",children:"#"}),"onNodeCreate/onNodeUpdate/onNodeDispose"]}),"\n",(0,o.jsx)(n.p,{children:"Node creation/update/destruction event, returns the event's disposal function"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",meta:"pure",children:"\nuseEffect(() => {\n  const toDispose1 = ctx.document.onNodeCreate((node) => {\n    console.log('onNodeCreate', node);\n  });\n  const toDispose2 = ctx.document.onNodeUpdate((node) => {\n    console.log('onNodeUpdate', node);\n  });\n  const toDispose3 = ctx.document.onNodeDispose((node) => {\n    console.log('onNodeDispose', node);\n  });\n  return () => {\n    toDispose1.dispose()\n    toDispose2.dispose()\n    toDispose3.dispose()\n  }\n}, []);\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"traverse",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#traverse",children:"#"}),"traverse"]}),"\n",(0,o.jsx)(n.p,{children:"Traverse all child nodes from the specified node, default root node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"/**\n *\n * traverse all nodes, O(n)\n *   R\n *   |\n *   +---1\n *   |   |\n *   |   +---1.1\n *   |   |\n *   |   +---1.2\n *   |   |\n *   |   +---1.3\n *   |   |    |\n *   |   |    +---1.3.1\n *   |   |    |\n *   |   |    +---1.3.2\n *   |   |\n *   |   +---1.4\n *   |\n *   +---2\n *       |\n *       +---2.1\n *\n *  sort: [1, 1.1, 1.2, 1.3, 1.3.1, 1.3.2, 1.4, 2, 2.1]\n */\nctx.document.traverse((node, depth, index) => {\n  console.log(node.id);\n}, ctx.document.root);\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"tostring",children:[(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#tostring",children:"#"}),"toString"]}),"\n",(0,o.jsx)(n.p,{children:"Return a string snapshot of the node structure"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",meta:"pure",children:"console.log(ctx.document.toString())\n"})})]})}function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,o.jsx)(n,Object.assign({},e,{children:(0,o.jsx)(s,e)})):s(e)}let a=r;r.__RSPRESS_PAGE_META={},r.__RSPRESS_PAGE_META["en%2Fapi%2Fcore%2Fflow-document.mdx"]={toc:[{id:"root",text:"root",depth:2},{id:"getallnodes",text:"getAllNodes",depth:2},{id:"getnode",text:"getNode",depth:2},{id:"getnoderegistry",text:"getNodeRegistry",depth:2},{id:"fromjsontojson",text:"fromJSON/toJSON",depth:2},{id:"registerflownodes",text:"registerFlowNodes",depth:2},{id:"addnode",text:"addNode",depth:2},{id:"addfromnode",text:"addFromNode",depth:2},{id:"addblock",text:"addBlock",depth:2},{id:"removenode",text:"removeNode",depth:2},{id:"onnodecreateonnodeupdateonnodedispose",text:"onNodeCreate/onNodeUpdate/onNodeDispose",depth:2},{id:"traverse",text:"traverse",depth:2},{id:"tostring",text:"toString",depth:2}],title:"FlowDocument",frontmatter:{}}}}]);